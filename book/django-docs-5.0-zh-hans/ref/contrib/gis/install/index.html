
<!DOCTYPE html>

<html lang="zh_Hans">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>GeoDjango 安装 &#8212; Django 5.0.3.dev20240221071519 文档</title>
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/default.css" />
    <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <link rel="index" title="索引" href="../../../../genindex.html" />
    <link rel="search" title="搜索" href="../../../../search.html" />
    <link rel="next" title="安装地理空间库" href="geolibs.html" />
    <link rel="prev" title="GeoDjango 教程" href="../tutorial.html" />



 
<script src="../../../../templatebuiltins.js"></script>
<script>
(function($) {
    if (!django_template_builtins) {
       // templatebuiltins.js missing, do nothing.
       return;
    }
    $(document).ready(function() {
        // Hyperlink Django template tags and filters
        var base = "../../../templates/builtins.html";
        if (base == "#") {
            // Special case for builtins.html itself
            base = "";
        }
        // Tags are keywords, class '.k'
        $("div.highlight\\-html\\+django span.k").each(function(i, elem) {
             var tagname = $(elem).text();
             if ($.inArray(tagname, django_template_builtins.ttags) != -1) {
                 var fragment = tagname.replace(/_/, '-');
                 $(elem).html("<a href='" + base + "#" + fragment + "'>" + tagname + "</a>");
             }
        });
        // Filters are functions, class '.nf'
        $("div.highlight\\-html\\+django span.nf").each(function(i, elem) {
             var filtername = $(elem).text();
             if ($.inArray(filtername, django_template_builtins.tfilters) != -1) {
                 var fragment = filtername.replace(/_/, '-');
                 $(elem).html("<a href='" + base + "#" + fragment + "'>" + filtername + "</a>");
             }
        });
    });
})(jQuery);</script>

  </head><body>

    <div class="document">
  <div id="custom-doc" class="yui-t6">
    <div id="hd">
      <h1><a href="../../../../index.html">Django 5.0.3.dev20240221071519 文档</a></h1>
      <div id="global-nav">
        <a title="Home page" href="../../../../index.html">Home</a>  |
        <a title="Table of contents" href="../../../../contents.html">Table of contents</a>  |
        <a title="Global index" href="../../../../genindex.html">Index</a>  |
        <a title="Module index" href="../../../../py-modindex.html">Modules</a>
      </div>
      <div class="nav">
    &laquo; <a href="../tutorial.html" title="GeoDjango 教程">previous</a>
     |
    <a href="../../../index.html" title="API 参考" accesskey="U">up</a>
   |
    <a href="geolibs.html" title="安装地理空间库">next</a> &raquo;</div>
    </div>

    <div id="bd">
      <div id="yui-main">
        <div class="yui-b">
          <div class="yui-g" id="ref-contrib-gis-install-index">
            
  <div class="section" id="s-geodjango-installation">
<span id="geodjango-installation"></span><h1>GeoDjango 安装<a class="headerlink" href="#geodjango-installation" title="永久链接至标题">¶</a></h1>
<div class="section" id="s-overview">
<span id="overview"></span><h2>概况<a class="headerlink" href="#overview" title="永久链接至标题">¶</a></h2>
<p>一般来说，GeoDjango 安装需要：</p>
<ol class="arabic simple">
<li><a class="reference internal" href="#django"><span class="std std-ref">Python 和 Django</span></a></li>
<li><a class="reference internal" href="#spatial-database"><span class="std std-ref">空间数据库</span></a></li>
<li><a class="reference internal" href="geolibs.html"><span class="doc">安装地理空间库</span></a></li>
</ol>
<p>以下各节提供了每项要求的细节和安装说明。此外，还提供了以下平台的具体说明：</p>
<ul class="simple">
<li><a class="reference internal" href="#macos"><span class="std std-ref">macOS</span></a></li>
<li><a class="reference internal" href="#windows"><span class="std std-ref">Windows</span></a></li>
</ul>
<div class="admonition-use-the-source admonition">
<p class="first admonition-title">使用源码</p>
<p class="last">因为 GeoDjango 利用了最新的开源地理空间软件技术，所以需要最新版本的库。如果你的平台没有二进制包，可能需要从源码安装。当从源码编译库时，请严格按照说明进行，尤其是当你是初学者时。</p>
</div>
</div>
<div class="section" id="s-requirements">
<span id="requirements"></span><h2>依赖项<a class="headerlink" href="#requirements" title="永久链接至标题">¶</a></h2>
<div class="section" id="s-python-and-django">
<span id="s-django"></span><span id="python-and-django"></span><span id="django"></span><h3>Python 和 Django<a class="headerlink" href="#python-and-django" title="永久链接至标题">¶</a></h3>
<p>因为 GeoDjango 是包含在 Django 中的，所以请参考 Django 的 <a class="reference internal" href="../../../../topics/install.html#installing-official-release"><span class="std std-ref">安装说明</span></a> 来详细了解如何安装。</p>
</div>
<div class="section" id="s-spatial-database">
<span id="s-id1"></span><span id="spatial-database"></span><span id="id1"></span><h3>空间数据库<a class="headerlink" href="#spatial-database" title="永久链接至标题">¶</a></h3>
<p>目前支持的空间数据库包括 PostgreSQL（带有 PostGIS）、MySQL、Oracle 和 SQLite（带有 SpatiaLite）。</p>
<div class="admonition note">
<p class="first admonition-title">备注</p>
<p class="last">推荐使用 PostGIS，因为它是最成熟、功能最丰富的开源空间数据库。</p>
</div>
<p>GeoDjango 安装所需的地理空间库取决于所使用的空间数据库。 下面列出了每个支持的数据库后端的库需求、支持的版本和任何注释。</p>
<table class="docutils">
<colgroup>
<col width="15%" />
<col width="24%" />
<col width="15%" />
<col width="46%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">数据库</th>
<th class="head">库依赖项</th>
<th class="head">支持的版本</th>
<th class="head">注意</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>PostgreSQL</td>
<td>GEOS, GDAL, PROJ, PostGIS</td>
<td>12+</td>
<td>需要 PostGIS。</td>
</tr>
<tr class="row-odd"><td>MySQL</td>
<td>GEOS, GDAL</td>
<td>8.0.11+</td>
<td><a class="reference internal" href="../db-api.html#mysql-spatial-limitations"><span class="std std-ref">功能受限</span></a>。</td>
</tr>
<tr class="row-even"><td>Oracle</td>
<td>GEOS, GDAL</td>
<td>19+</td>
<td>不支持 XE。</td>
</tr>
<tr class="row-odd"><td>SQLite</td>
<td>GEOS, GDAL, PROJ, SpatiaLite</td>
<td>3.27.0+</td>
<td>需要 SpatiaLite 4.3+</td>
</tr>
</tbody>
</table>
<p>关于 PostgreSQL／PostGIS／GEOS／GDAL的可能组合，也请参见 OSGeo Wiki 上的 <a href="#id23"><span class="problematic" id="id24">`这个比较矩阵`__</span></a> 。</p>
</div>
</div>
<div class="section" id="s-installation">
<span id="installation"></span><h2>安装<a class="headerlink" href="#installation" title="永久链接至标题">¶</a></h2>
<div class="section" id="s-geospatial-libraries">
<span id="geospatial-libraries"></span><h3>地理空间库<a class="headerlink" href="#geospatial-libraries" title="永久链接至标题">¶</a></h3>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="geolibs.html">安装地理空间库</a></li>
</ul>
</div>
</div>
<div class="section" id="s-database-installation">
<span id="database-installation"></span><h3>数据库安装<a class="headerlink" href="#database-installation" title="永久链接至标题">¶</a></h3>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="postgis.html">安装 PostGIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="spatialite.html">安装 SpatiaLite</a></li>
</ul>
</div>
</div>
<div class="section" id="s-databases-configuration">
<span id="databases-configuration"></span><h3><a class="reference internal" href="../../../settings.html#std-setting-DATABASES"><code class="xref std std-setting docutils literal notranslate"><span class="pre">DATABASES</span></code></a> 配置<a class="headerlink" href="#databases-configuration" title="永久链接至标题">¶</a></h3>
<p>将 <a class="reference internal" href="../../../settings.html#std-setting-DATABASE-ENGINE"><code class="xref std std-setting docutils literal notranslate"><span class="pre">ENGINE</span></code></a> 设置为 <a class="reference internal" href="../db-api.html#spatial-backends"><span class="std std-ref">空间后端</span></a> 之一。</p>
</div>
<div class="section" id="s-add-django-contrib-gis-to-installed-apps">
<span id="add-django-contrib-gis-to-installed-apps"></span><h3>添加 <code class="docutils literal notranslate"><span class="pre">django.contrib.gis</span></code> 到 <a class="reference internal" href="../../../settings.html#std-setting-INSTALLED_APPS"><code class="xref std std-setting docutils literal notranslate"><span class="pre">INSTALLED_APPS</span></code></a><a class="headerlink" href="#add-django-contrib-gis-to-installed-apps" title="永久链接至标题">¶</a></h3>
<p>和其他 Django contrib 应用一样，你只需要在配置中的 <a class="reference internal" href="../../../settings.html#std-setting-INSTALLED_APPS"><code class="xref std std-setting docutils literal notranslate"><span class="pre">INSTALLED_APPS</span></code></a> 中添加 <a class="reference internal" href="../index.html#module-django.contrib.gis" title="django.contrib.gis: Geographic Information System (GIS) extensions for Django"><code class="xref py py-mod docutils literal notranslate"><span class="pre">django.contrib.gis</span></code></a>。这是为了让 <code class="docutils literal notranslate"><span class="pre">gis</span></code> 模板能够被定位 —— 如果不这样做，那么诸如地理管理或 KML 网站地图等功能将无法正常运行。</p>
</div>
</div>
<div class="section" id="s-troubleshooting">
<span id="troubleshooting"></span><h2>错误调试<a class="headerlink" href="#troubleshooting" title="永久链接至标题">¶</a></h2>
<p>如果你在这里找不到解决问题的方法，那就参与社区吧！你可以：</p>
<ul class="simple">
<li>加入 Libera.Chat 上的 <code class="docutils literal notranslate"><span class="pre">#django-geo</span></code> IRC 频道。请耐心和礼貌 -- 尽管您可能不会立即得到回复，但只要有人看到您的问题，他们会尽快尝试回答。</li>
<li>在 <a href="#id23"><span class="problematic" id="id25">`GeoDjango`__</span></a> 论坛上提出您的问题。</li>
<li>如果你认为有 bug，请在 <a href="#id23"><span class="problematic" id="id26">`Django trac`__</span></a> 上提交一个工单。 确保提供完整的问题描述，使用的版本，并指定组件为 “GIS”。</li>
</ul>
<div class="section" id="s-library-environment-settings">
<span id="s-libsettings"></span><span id="library-environment-settings"></span><span id="libsettings"></span><h3>库环境配置<a class="headerlink" href="#library-environment-settings" title="永久链接至标题">¶</a></h3>
<p>到目前为止，安装 GeoDjango 时最常见的问题是无法找到外部共享库（例如 GEOS 和 GDAL）。<a class="footnote-reference" href="#id22" id="id5">[1]</a> 通常情况下，造成这个问题的原因是操作系统不知道从源码建立的库的安装目录。</p>
<p>一般情况下，库路径可以通过设置环境变量按每个用户来设置，也可以为整个系统配置库路径。</p>
<div class="section" id="s-ld-library-path-environment-variable">
<span id="ld-library-path-environment-variable"></span><h4><code class="docutils literal notranslate"><span class="pre">LD_LIBRARY_PATH</span></code> 环境变量<a class="headerlink" href="#ld-library-path-environment-variable" title="永久链接至标题">¶</a></h4>
<p>用户可以设置这个环境变量来自定义他们想要使用的库路径。从源代码构建的软件的典型库目录是 <code class="docutils literal notranslate"><span class="pre">/usr/local/lib</span></code>。因此，<code class="docutils literal notranslate"><span class="pre">/usr/local/lib</span></code> 需要包含在 <code class="docutils literal notranslate"><span class="pre">LD_LIBRARY_PATH</span></code> 变量中。例如，用户可以将以下内容放入他们的 bash 配置文件中：</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">LD_LIBRARY_PATH</span><span class="o">=</span>/usr/local/lib
</pre></div>
</div>
</div>
<div class="section" id="s-setting-system-library-path">
<span id="setting-system-library-path"></span><h4>设置系统库路径<a class="headerlink" href="#setting-system-library-path" title="永久链接至标题">¶</a></h4>
<p>在 GNU/Linux 系统上，通常在 <code class="docutils literal notranslate"><span class="pre">/etc/ld.so.conf</span></code> 中有一个文件，该文件可以包含来自另一个目录的文件中的额外路径，例如 <code class="docutils literal notranslate"><span class="pre">/etc/ld.so.conf.d</span></code>。作为 root 用户，在 <code class="docutils literal notranslate"><span class="pre">ld.so.conf</span></code> 中的新行中添加自定义库路径（例如 <code class="docutils literal notranslate"><span class="pre">/usr/local/lib</span></code>）。这是如何做的一个示例：</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ sudo <span class="nb">echo</span> /usr/local/lib &gt;&gt; /etc/ld.so.conf
$ sudo ldconfig
</pre></div>
</div>
<p>对于 OpenSolaris 用户，可以使用 <code class="docutils literal notranslate"><span class="pre">crle</span></code> 实用程序来修改系统库路径。运行 <code class="docutils literal notranslate"><span class="pre">crle</span></code> 不带选项可以查看当前配置，使用 <code class="docutils literal notranslate"><span class="pre">crle</span> <span class="pre">-l</span></code> 来设置新的库路径。在修改系统库路径时要非常小心：</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="c1"># crle -l $OLD_PATH:/usr/local/lib</span>
</pre></div>
</div>
</div>
<div class="section" id="s-install-binutils">
<span id="s-binutils"></span><span id="install-binutils"></span><span id="binutils"></span><h4>安装 <code class="docutils literal notranslate"><span class="pre">binutils</span></code><a class="headerlink" href="#install-binutils" title="永久链接至标题">¶</a></h4>
<p>GeoDjango 使用 <code class="docutils literal notranslate"><span class="pre">find_library</span></code> 函数（来自 <code class="docutils literal notranslate"><span class="pre">ctypes.util</span></code> Python 模块）来发现库。 <code class="docutils literal notranslate"><span class="pre">find_library</span></code> 例程使用一个叫做 <code class="docutils literal notranslate"><span class="pre">objdump</span></code> 的程序（<code class="docutils literal notranslate"><span class="pre">binutils</span></code> 包的一部分）来验证 GNU／Linux 系统的共享库。 因此，如果 <code class="docutils literal notranslate"><span class="pre">binutils</span></code> 没有安装在你的 Linux 系统上，那么 Python 的 ctypes 可能无法找到你的库，即使你的库路径设置正确，并且地理空间库建立得很完美。</p>
<p>在 Debian 和 Ubuntu 系统上，可以使用以下命令安装 <code class="docutils literal notranslate"><span class="pre">binutils</span></code> 软件包：</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ sudo apt-get install binutils
</pre></div>
</div>
<p>类似地，在 Red Hat 和 CentOS 系统上：</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ sudo yum install binutils
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="s-platform-specific-instructions">
<span id="platform-specific-instructions"></span><h2>特定平台说明<a class="headerlink" href="#platform-specific-instructions" title="永久链接至标题">¶</a></h2>
<div class="section" id="s-macos">
<span id="s-id6"></span><span id="macos"></span><span id="id6"></span><h3>macOS<a class="headerlink" href="#macos" title="永久链接至标题">¶</a></h3>
<p>由于 macOS 的打包系统多种多样，用户在安装 GeoDjango 时有几种不同的选择。这些选择是：</p>
<ul class="simple">
<li><a class="reference internal" href="#postgresapp"><span class="std std-ref">Postgres.app</span></a> （最简易且推荐）</li>
<li><a class="reference internal" href="#homebrew"><span class="std std-ref">Homebrew</span></a></li>
<li><a class="reference internal" href="#fink"><span class="std std-ref">Fink</span></a></li>
<li><a class="reference internal" href="#macports"><span class="std std-ref">MacPorts</span></a></li>
<li><a class="reference internal" href="geolibs.html#build-from-source"><span class="std std-ref">从源码构建</span></a></li>
</ul>
<p>这一节还包含了从 Python 软件基金会提供的软件包中安装升级版 <a class="reference internal" href="#macos-python"><span class="std std-ref">Python</span></a> 的说明，但是，这不是必须的。</p>
<div class="section" id="s-python">
<span id="s-macos-python"></span><span id="python"></span><span id="macos-python"></span><h4>Python<a class="headerlink" href="#python" title="永久链接至标题">¶</a></h4>
<p>虽然 macOS 安装了 Python，但用户可以使用 Python 软件基金会提供的 <a href="#id23"><span class="problematic" id="id27">`框架安装程序`__</span></a> 。 使用安装程序的一个好处是，macOS 的 Python 将保持 “原始” 状态，供操作系统内部使用。</p>
<div class="admonition note">
<p class="first admonition-title">备注</p>
<p>您需要修改您的 <code class="docutils literal notranslate"><span class="pre">.profile</span></code> 文件中的 <code class="docutils literal notranslate"><span class="pre">PATH</span></code> 环境变量，以便在命令行输入 <code class="docutils literal notranslate"><span class="pre">python</span></code> 时使用新版本的 Python：</p>
<div class="last highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span>/Library/Frameworks/Python.framework/Versions/Current/bin:<span class="nv">$PATH</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="s-postgres-app">
<span id="s-postgresapp"></span><span id="postgres-app"></span><span id="postgresapp"></span><h4>Postgres.app<a class="headerlink" href="#postgres-app" title="永久链接至标题">¶</a></h4>
<p><a class="reference external" href="https://postgresapp.com/">Postgres.app</a> 是一个独立的 PostgreSQL 服务，包括 PostGIS 扩展。你还需要安装 <code class="docutils literal notranslate"><span class="pre">gdal</span></code> 和 <code class="docutils literal notranslate"><span class="pre">libgeoip</span></code>，并安装 <a class="reference internal" href="#homebrew"><span class="std std-ref">Homebrew</span></a>。</p>
<p>安装 Postgres.app 后，在你的 <code class="docutils literal notranslate"><span class="pre">.bash_profile</span></code> 中添加以下内容，这样你就可以在命令行中运行软件包的程序。用你安装的 Postgres.app 中的 PostgreSQL 版本替换 <code class="docutils literal notranslate"><span class="pre">X.Y</span></code>：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="nv">$PATH</span>:/Applications/Postgres.app/Contents/Versions/X.Y/bin
</pre></div>
</div>
<p>你可以在终端提示符下输入 <code class="docutils literal notranslate"><span class="pre">which</span> <span class="pre">psql</span></code> 检查路径是否设置正确。</p>
</div>
<div class="section" id="s-homebrew">
<span id="s-id9"></span><span id="homebrew"></span><span id="id9"></span><h4>Homebrew<a class="headerlink" href="#homebrew" title="永久链接至标题">¶</a></h4>
<p><a href="#id23"><span class="problematic" id="id28">`Homebrew`__</span></a> 提供了从源码中构建二进制文件和软件包的 “菜谱”。它为运行 macOS 的 Macintosh 电脑提供了 GeoDjango 的先决条件。因为 Homebrew 仍然从源码构建软件，所以需要使用 <a class="reference external" href="https://developer.apple.com/xcode/">Xcode</a> 。</p>
<p>摘要：</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ brew install postgresql
$ brew install postgis
$ brew install gdal
$ brew install libgeoip
</pre></div>
</div>
<div class="section" id="s-fink">
<span id="s-id11"></span><span id="fink"></span><span id="id11"></span><h5>Fink<a class="headerlink" href="#fink" title="永久链接至标题">¶</a></h5>
<p><a href="#id23"><span class="problematic" id="id29">`Kurt Schwehr`__</span></a> 很慷慨地为 <a href="#id23"><span class="problematic" id="id30">`Fink`__</span></a> 包系统的用户创建了 GeoDjango 包。根据你想使用的 Python 版本，可以使用不同的包（从 <code class="docutils literal notranslate"><span class="pre">django-gis</span></code> 开始）。</p>
</div>
</div>
<div class="section" id="s-macports">
<span id="s-id15"></span><span id="macports"></span><span id="id15"></span><h4>MacPorts<a class="headerlink" href="#macports" title="永久链接至标题">¶</a></h4>
<p><a href="#id23"><span class="problematic" id="id31">`MacPorts`__</span></a> 可以用来在运行 macOS 的计算机上安装 GeoDjango 的先决条件。 因为 MacPorts 仍然从源码构建软件，所以需要使用 <a class="reference external" href="https://developer.apple.com/xcode/">Xcode</a> 。</p>
<p>摘要：</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ sudo port install postgresql13-server
$ sudo port install geos
$ sudo port install proj6
$ sudo port install postgis3
$ sudo port install gdal
$ sudo port install libgeoip
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">备注</p>
<p>您还需要在您的 <code class="docutils literal notranslate"><span class="pre">.profile</span></code> 中修改 <code class="docutils literal notranslate"><span class="pre">PATH</span></code>，以便从命令行访问 MacPorts 程序：</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span>/opt/local/bin:/opt/local/lib/postgresql13/bin
</pre></div>
</div>
<p>此外，添加 <code class="docutils literal notranslate"><span class="pre">DYLD_FALLBACK_LIBRARY_PATH</span></code> 设置以便 Python 可以找到这些库：</p>
<div class="last highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">DYLD_FALLBACK_LIBRARY_PATH</span><span class="o">=</span>/opt/local/lib:/opt/local/lib/postgresql13
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="s-windows">
<span id="s-id17"></span><span id="windows"></span><span id="id17"></span><h3>Windows<a class="headerlink" href="#windows" title="永久链接至标题">¶</a></h3>
<p>为了在 Windows 上安装 GeoDjango，请依次完成以下章节。在本教程中，我们将安装每个应用程序的 64 位版本。</p>
<div class="section" id="s-id18">
<span id="id18"></span><h4>Python<a class="headerlink" href="#id18" title="永久链接至标题">¶</a></h4>
<p>安装一个 64 位版本的 Python。更多信息请参见 <a class="reference internal" href="../../../../howto/windows.html"><span class="doc">安装 Python</span></a>。</p>
</div>
<div class="section" id="s-postgresql">
<span id="postgresql"></span><h4>PostgreSQL<a class="headerlink" href="#postgresql" title="永久链接至标题">¶</a></h4>
<p>从 <a href="#id23"><span class="problematic" id="id32">`EnterpriseDB`__</span></a> 网站下载最新的 <a href="#id23"><span class="problematic" id="id33">`PostgreSQL 15.x 安装程序`__</span></a>。下载完成后，运行安装程序，按照屏幕上的提示进行操作，除非您知道更改选项的后果，否则保持默认选项。</p>
<div class="admonition note">
<p class="first admonition-title">备注</p>
<p class="last">PostgreSQL 安装程序会创建一个新的 <code class="docutils literal notranslate"><span class="pre">postgres</span></code> 数据库超级用户，你会被提示设置一次密码 —— 一定要记住它！</p>
</div>
<p>当安装程序完成时，它会询问 “在退出时启动 Stack Builder?” —— 请确定这个问题，因为需要安装 <a class="reference internal" href="#postgisasb"><span class="std std-ref">PostGIS</span></a>。</p>
<div class="admonition note">
<p class="first admonition-title">备注</p>
<p class="last">如果成功安装，每次系统启动时，PostgreSQL 服务器将作为 Windows 服务在后台运行。将创建一个 <span class="menuselection">PostgreSQL 15</span> 的开始菜单组，其中包含 Application Stack Builder (ASB) 和 'SQL Shell' 的快捷方式，后者将启动一个 <code class="docutils literal notranslate"><span class="pre">psql</span></code> 命令窗口。</p>
</div>
</div>
<div class="section" id="s-postgis">
<span id="s-postgisasb"></span><span id="postgis"></span><span id="postgisasb"></span><h4>PostGIS<a class="headerlink" href="#postgis" title="永久链接至标题">¶</a></h4>
<p>在 Stack Builder 中（在安装程序外运行，选择 <span class="menuselection">开始 ‣ PostgreSQL 15 ‣ Application Stack Builder</span>），从下拉菜单中选择 <span class="menuselection">PostgreSQL 15 (x64) on port 5432</span>，然后点击下一步。展开 <span class="menuselection">类别 ‣ 空间扩展</span> 菜单树，并选择 <span class="menuselection">PostGIS X.Y for PostgreSQL 15</span>。</p>
<p>点击下一步后，您将被提示确认所选的包和“下载目录”。再次点击下一步，这将下载 PostGIS，并要求您点击下一步开始 PostGIS 安装程序。在安装过程中，包括四个 Yes/No 对话框，所有四个的默认选项都是 &quot;No&quot;。</p>
</div>
<div class="section" id="s-osgeo4w">
<span id="s-id21"></span><span id="osgeo4w"></span><span id="id21"></span><h4>OSGeo4W<a class="headerlink" href="#osgeo4w" title="永久链接至标题">¶</a></h4>
<p><a class="reference external" href="https://trac.osgeo.org/osgeo4w/">OSGeo4W installer</a> 可以帮助安装 GeoDjango 所需的 PROJ、GDAL 和 GEOS 库。首先，下载 <a class="reference external" href="https://trac.osgeo.org/osgeo4w/">OSGeo4W installer</a> 并运行它。选择 <span class="menuselection">Express Web-GIS Install</span> 然后点击下一步。在 'Select Packages' 列表中，确保选择了 GDAL。如果默认启用了其他任何软件包，它们对于 GeoDjango 是不需要的，可以安全地取消选中。点击下一步并接受许可协议后，软件包将被自动下载和安装，然后您可以退出安装程序。</p>
</div>
<div class="section" id="s-modify-windows-environment">
<span id="modify-windows-environment"></span><h4>修改 Windows 环境<a class="headerlink" href="#modify-windows-environment" title="永久链接至标题">¶</a></h4>
<p>为了使用 GeoDjango，你需要将 OSGeo4W 目录添加到 Windows 系统的 <code class="docutils literal notranslate"><span class="pre">Path</span></code> 中，并创建 <code class="docutils literal notranslate"><span class="pre">GDAL_DATA</span></code> 和 <code class="docutils literal notranslate"><span class="pre">PROJ_LIB</span></code> 环境变量。 下面这组命令可以用 <code class="docutils literal notranslate"><span class="pre">cmd.exe</span></code> 执行，用于设置。设置完成后，请重新启动设备，以便识别新的环境变量。</p>
<div class="highlight-bat notranslate"><div class="highlight"><pre><span></span><span class="k">set</span> <span class="nv">OSGEO4W_ROOT</span><span class="p">=</span>C:\OSGeo4W
<span class="k">set</span> <span class="nv">GDAL_DATA</span><span class="p">=</span><span class="nv">%OSGEO4W_ROOT%</span>\apps\gdal\share\gdal
<span class="k">set</span> <span class="nv">PROJ_LIB</span><span class="p">=</span><span class="nv">%OSGEO4W_ROOT%</span>\share\proj
<span class="k">set</span> <span class="nv">PATH</span><span class="p">=</span><span class="nv">%PATH%</span>;<span class="nv">%OSGEO4W_ROOT%</span>\bin
reg ADD <span class="s2">&quot;HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment&quot;</span> /v Path /t REG_EXPAND_SZ /f /d <span class="s2">&quot;</span><span class="nv">%PATH%</span><span class="s2">&quot;</span>
reg ADD <span class="s2">&quot;HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment&quot;</span> /v GDAL_DATA /t REG_EXPAND_SZ /f /d <span class="s2">&quot;</span><span class="nv">%GDAL_DATA%</span><span class="s2">&quot;</span>
reg ADD <span class="s2">&quot;HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment&quot;</span> /v PROJ_LIB /t REG_EXPAND_SZ /f /d <span class="s2">&quot;</span><span class="nv">%PROJ_LIB%</span><span class="s2">&quot;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">备注</p>
<p class="last">执行这些命令需要管理员权限。要做到这一点，请以管理员身份运行命令提示符，并输入上述命令。你需要注销并重新登录，设置才会生效。</p>
</div>
<div class="admonition note">
<p class="first admonition-title">备注</p>
<p class="last">如果你自定义了 OSGeo4W 的安装目录，那么你需要相应地修改 <code class="docutils literal notranslate"><span class="pre">OSGEO4W_ROOT</span></code> 变量。</p>
</div>
</div>
<div class="section" id="s-install-django-and-set-up-database">
<span id="install-django-and-set-up-database"></span><h4>安装 Django 并建立数据库<a class="headerlink" href="#install-django-and-set-up-database" title="永久链接至标题">¶</a></h4>
<p>在您的系统上 <a class="reference internal" href="../../../../topics/install.html#installing-official-release"><span class="std std-ref">安装 Django</span></a>。建议为您创建的每个项目创建一个 <a class="reference external" href="https://docs.python.org/3/tutorial/venv.html" title="(在 Python v3.12)"><span class="xref std std-doc">虚拟环境</span></a>。</p>
</div>
<div class="section" id="s-psycopg">
<span id="psycopg"></span><h4>psycopg<a class="headerlink" href="#psycopg" title="永久链接至标题">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">psycopg</span></code> Python 模块提供了 Python 和 PostgreSQL 数据库之间的接口。您可以在 Python 虚拟环境中使用 pip 安装 <code class="docutils literal notranslate"><span class="pre">psycopg</span></code>：</p>
<div class="highlight-doscon notranslate"><div class="highlight"><pre><span></span><span class="gp">...\&gt;</span> py -m pip install psycopg
</pre></div>
</div>
<p class="rubric">脚注</p>
<table class="docutils footnote" frame="void" id="id22" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[1]</a></td><td>GeoDjango 使用 <code class="docutils literal notranslate"><span class="pre">ctypes.util</span></code> 中的 <a class="reference external" href="https://docs.python.org/3/library/ctypes.html#ctypes.util.find_library" title="(在 Python v3.12)"><code class="xref py py-func docutils literal notranslate"><span class="pre">find_library()</span></code></a> 例程来查找共享库。</td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      
        
          <div class="yui-b" id="sidebar">
            
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../../../contents.html">目录</a></h3>
    <ul>
<li><a class="reference internal" href="#">GeoDjango 安装</a><ul>
<li><a class="reference internal" href="#overview">概况</a></li>
<li><a class="reference internal" href="#requirements">依赖项</a><ul>
<li><a class="reference internal" href="#python-and-django">Python 和 Django</a></li>
<li><a class="reference internal" href="#spatial-database">空间数据库</a></li>
</ul>
</li>
<li><a class="reference internal" href="#installation">安装</a><ul>
<li><a class="reference internal" href="#geospatial-libraries">地理空间库</a></li>
<li><a class="reference internal" href="#database-installation">数据库安装</a></li>
<li><a class="reference internal" href="#databases-configuration"><code class="xref std std-setting docutils literal notranslate"><span class="pre">DATABASES</span></code> 配置</a></li>
<li><a class="reference internal" href="#add-django-contrib-gis-to-installed-apps">添加 <code class="docutils literal notranslate"><span class="pre">django.contrib.gis</span></code> 到 <code class="xref std std-setting docutils literal notranslate"><span class="pre">INSTALLED_APPS</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#troubleshooting">错误调试</a><ul>
<li><a class="reference internal" href="#library-environment-settings">库环境配置</a><ul>
<li><a class="reference internal" href="#ld-library-path-environment-variable"><code class="docutils literal notranslate"><span class="pre">LD_LIBRARY_PATH</span></code> 环境变量</a></li>
<li><a class="reference internal" href="#setting-system-library-path">设置系统库路径</a></li>
<li><a class="reference internal" href="#install-binutils">安装 <code class="docutils literal notranslate"><span class="pre">binutils</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#platform-specific-instructions">特定平台说明</a><ul>
<li><a class="reference internal" href="#macos">macOS</a><ul>
<li><a class="reference internal" href="#python">Python</a></li>
<li><a class="reference internal" href="#postgres-app">Postgres.app</a></li>
<li><a class="reference internal" href="#homebrew">Homebrew</a><ul>
<li><a class="reference internal" href="#fink">Fink</a></li>
</ul>
</li>
<li><a class="reference internal" href="#macports">MacPorts</a></li>
</ul>
</li>
<li><a class="reference internal" href="#windows">Windows</a><ul>
<li><a class="reference internal" href="#id18">Python</a></li>
<li><a class="reference internal" href="#postgresql">PostgreSQL</a></li>
<li><a class="reference internal" href="#postgis">PostGIS</a></li>
<li><a class="reference internal" href="#osgeo4w">OSGeo4W</a></li>
<li><a class="reference internal" href="#modify-windows-environment">修改 Windows 环境</a></li>
<li><a class="reference internal" href="#install-django-and-set-up-database">安装 Django 并建立数据库</a></li>
<li><a class="reference internal" href="#psycopg">psycopg</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>上一个主题</h4>
    <p class="topless"><a href="../tutorial.html"
                          title="上一章">GeoDjango 教程</a></p>
  </div>
  <div>
    <h4>下一个主题</h4>
    <p class="topless"><a href="geolibs.html"
                          title="下一章">安装地理空间库</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>本页</h3>
    <ul class="this-page-menu">
      <li><a href="../../../../_sources/ref/contrib/gis/install/index.txt"
            rel="nofollow">显示源代码</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">快速搜索</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="转向" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
              <h3>Last update:</h3>
              <p class="topless">2月 21, 2024</p>
          </div>
        
      
    </div>

    <div id="ft">
      <div class="nav">
    &laquo; <a href="../tutorial.html" title="GeoDjango 教程">previous</a>
     |
    <a href="../../../index.html" title="API 参考" accesskey="U">up</a>
   |
    <a href="geolibs.html" title="安装地理空间库">next</a> &raquo;</div>
    </div>
  </div>

      <div class="clearer"></div>
    </div>
  </body>
</html>